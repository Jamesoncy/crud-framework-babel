{"version":3,"sources":["../../app/system/Database.js"],"names":["Database","db","mysqlExecute","mssqlExecute","host","user","password","database","connjson","conn","connection","msConnJson","msconnection","bluebird","promisifyAll","mysql","createConnection","mssql","sql","ConnectionPool","connect","pool","request","result","connms","server","options","abortTransactionOnError","connectionLimit","queueLimit","acquireTimeout","module","exports"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;;;IAEMA,Q;;;;;;;;;QAEWC,E,uEAAG,I;;;;;cACfA,MAAM,I;;;;;sBACDA,E;wCACD,M,uBAEA,Q;;;;;eAFqB,KAAKC,YAAL,CAAkB,WAAlB,EAA8B,MAA9B,EAAqC,cAArC,EAAoD,MAApD,C;;;;;;;eAEE,KAAKC,YAAL,CAAkB,eAAlB,EAAkC,UAAlC,EAA6C,OAA7C,EAAqD,WAArD,C;;;;;;;;;;;;;;;;;;;;;;0GAMZC,I,EAAKC,I,EAAKC,Q,EAASC,Q;;;;;;;eACpB,KAAKC,QAAL,CAAcJ,IAAd,EAAmBC,IAAnB,EAAwBC,QAAxB,EAAiCC,QAAjC,C;;;AAAbE,Y;;eACS,KAAKC,UAAL,CAAgBD,IAAhB,C;;;;;;;;;;;;;;;;;;;;;;0GAGKL,I,EAAKC,I,EAAKC,Q,EAASC,Q;;;;;;;eACpB,KAAKI,UAAL,CAAgBP,IAAhB,EAAqBC,IAArB,EAA0BC,QAA1B,EAAmCC,QAAnC,C;;;AAAbE,Y;;eACS,KAAKG,YAAL,CAAkBH,IAAlB,C;;;;;;;;;;;;;;;;;;;;;;0GAGGA,I;;;;;0CACTI,mBAASC,YAAT,CAAsBC,gBAAMC,gBAAN,CAAuBP,IAAvB,CAAtB,C;;;;;;;;;;;;;;;;;;;0GAGWA,I;;;;;;AACdQ,a,GAAQJ,mBAASC,YAAT,CAAsBI,eAAtB,C;;eACC,IAAID,MAAME,cAAV,CAAyBV,IAAzB,EAA+BW,OAA/B,E;;;AAAbC,Y;;eACeA,KAAKC,OAAL,E;;;AAAfC,c;0CAEOA,M;;;;;;;;;;;;;;;;;;;0GAGSnB,I,EAAKC,I,EAAKC,Q,EAASC,Q;;;;;;AAC/BiB,c,GAAS;AACZnB,eAAMA,IADM;AAEZC,mBAAUA,QAFE;AAGZmB,iBAAQrB,IAHI;AAIZG,mBAAUA,QAJE;AAKZmB,kBAAS;AACRC,mCAAyB,IADjB,CACsB;AADtB;AALG,S;0CASNH,M;;;;;;;;;;;;;;;;;;;0GAGOpB,I,EAAKC,I,EAAKC,Q,EAASC,Q;;;;;0CAC1B;AACNH,eAAMA,IADA;AAENC,eAAMA,IAFA;AAGNC,mBAAUA,QAHJ;AAINC,mBAAUA,QAJJ;AAKNqB,0BAAiB,IALX;AAMNC,qBAAY,CAAC,CANP,EAMUC,gBAAgB;AAN1B,S;;;;;;;;;;;;;;;;;;;;AAYTC,OAAOC,OAAP,GAAiBhC,QAAjB","file":"Database.js","sourcesContent":["'use strict'\r\nimport bluebird from 'bluebird'\r\nimport mysql from 'mysql'\r\nimport sql from 'mssql'\r\n\r\nclass Database  {\r\n\r\n\tasync connectdb(db=null){\r\n\t\tif(db != null){\r\n\t\t\tswitch(db){\r\n\t\t\t\tcase 'srsn': return await this.mysqlExecute(\"localhost\",\"root\",\"password!@#$\",\"test\")\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase 'srsnms': return await this.mssqlExecute(\"192.168.0.148\",\"markuser\",\"tseug\",\"NOVA_JADE\")\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync mysqlExecute(host,user,password,database){\r\n\t\tlet conn = await this.connjson(host,user,password,database)\r\n\t\treturn await this.connection(conn)\r\n\t}\r\n\r\n\tasync mssqlExecute(host,user,password,database){\r\n\t\tlet conn = await this.msConnJson(host,user,password,database)\r\n\t\treturn await this.msconnection(conn)\r\n\t}\r\n\r\n\tasync connection(conn){\r\n\t\treturn bluebird.promisifyAll(mysql.createConnection(conn))\r\n\t}\r\n\r\n\tasync msconnection(conn){\r\n\t\tlet mssql = bluebird.promisifyAll(sql),\r\n\t\tpool = await new mssql.ConnectionPool(conn).connect(),\r\n\t\tresult = await pool.request()\r\n\t\t// await pool.close()\r\n\t\treturn result\r\n\t}\r\n\r\n\tasync msConnJson(host,user,password,database){\r\n\t\tlet connms = {\r\n\t\t\tuser: user,\r\n\t\t\tpassword: password,\r\n\t\t\tserver: host, \r\n\t\t\tdatabase: database,\r\n\t\t\toptions: {\r\n\t\t\t\tabortTransactionOnError: true // <-- SET XACT_ABORT ON\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn connms\r\n\t}\r\n\r\n\tasync connjson(host,user,password,database){\r\n\t\treturn { \r\n\t\t\thost: host,\r\n\t\t\tuser: user,\r\n\t\t\tpassword: password,\r\n\t\t\tdatabase: database,\r\n\t\t\tconnectionLimit: 1000,\r\n\t\t\tqueueLimit: -1, acquireTimeout: 2\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = Database"]}